rule:
  meta:
    name: encrypt data using RC4 via SystemFunction032
    namespace: data-manipulation/encryption/rc4
    authors:
      - richard.weiss@mandiant.com
    scope: function
    att&ck:
      - Defense Evasion::Obfuscated Files or Information [T1027]
    mbc:
      - Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]
      - Cryptography::Encrypt Data::RC4 [C0027.009]
    references:
      - https://doxygen.reactos.org/df/d13/sysfunc_8c_source.html
      - https://blog.gentilkiwi.com/tag/systemfunction032
    examples:
      - 1F31917FFF1E43B0BBC72576906B0746A88F978084FADA49312900B5241A9FC8:0x14009E058 # SystemFunction032
  features:
    - or:
      - api: SystemFunction032
      - and:
        - or:
          - substring: "Advapi32"
          - substring: "cryptsp"
        - string: "SystemFunction032"
          description: Procedure Address resolved at runtime
