rule:
  meta:
    name: encrypt data using RC4 via WinAPI SystemFunctionXXX Procedures
    namespace: data-manipulation/encryption/rc4
    authors:
      - richard.weiss@mandiant.com
    scope: function
    att&ck:
      - Defense Evasion::Obfuscated Files or Information [T1027]
    mbc:
      - Defense Evasion::Obfuscated Files or Information::Encryption-Standard Algorithm [E1027.m05]
      - Cryptography::Encrypt Data::RC4 [C0027.009]
    references:
      - https://doxygen.reactos.org/df/d13/sysfunc_8c_source.html
      - https://blog.gentilkiwi.com/tag/systemfunction032
  features:
      - or:
        - api: SystemFunction032
        - optional:
          - and:
            - string: Advapi32.dll
            - string: SystemFunction032
              description: Procedure Address resolved at runtime
