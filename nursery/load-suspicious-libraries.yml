rule:
  meta:
    name: load suspicious libraries
    namespace: nursery
    scope: file
    references:
      - https://www.welivesecurity.com/2021/04/06/janeleiro-time-traveler-new-old-banking-trojan-brazil/
    examples:
      - 387f15043f0198fd3a637b0758c2b6dde9ead795c3ed70803426fc355731b173
      - 7f4ba9fc95b30baf8922a6933a4ff1c6a7fef41fae487bb31014c4963357770f
    authors:
      - johnk3r
  features:
    - and:
      - match: compiled to the .NET platform
      - or:
        - string: ProcessedByFody #Used to load every other third-party tool, or trojan component, such as LoadSystem in version 0.0.4.
        - string: SharpVectors.Converters.Wpf #Used to load SVG images contained in resources. These images are logos of several banks used by the fake pop-up windows.
        - string: Newtonsoft.Json #Used to parse the data returned by the geoPlugin web service.
        - string: RijndaelEncryptDecrypt #Used to encrypt and decrypt its strings. Functions were modified to contain the key, so it’s not present in the trojan’s code.
        - string: SharpClipboard #Used for clipboard hijacking: when the user copies a bitcoin address, Janeleiro replaces it with one randomly chosen from a list of its own.
        - class: ProcessedByFody #Used to load every other third-party tool, or trojan component
        - class: Costura.AssemblyLoader #Costura is an add-in for Fody
        - namespace: Costura #Costura is an add-in for Fody
